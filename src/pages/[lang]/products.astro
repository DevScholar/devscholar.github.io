---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Sidebar from '../../components/Sidebar.astro';
import { getCollection } from 'astro:content';
import { getLangFromUrl, useTranslations } from '../../i18n/ui';

export function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
    { params: { lang: 'zh-cn' } },
  ];
}

const { lang } = Astro.params;
const t = useTranslations(lang as any);

const products = await getCollection('products');
---

<BaseLayout title={t('products') + ' - DevScholar'}>
	<Header slot="header" />
	<Sidebar slot="sidebar" />
	
	<section class="products">
		<h1>{t('myProducts')}</h1>
		<ul>
			{products.map((product) => (
				<li>
					<h2>{product.data.name}</h2>
					<p>{product.data.description}</p>
					<p><strong>{t('category')}:</strong> {product.data.category}</p>
					{product.data.website && (
						<p><a href={product.data.website}>{t('visitWebsite')}</a></p>
					)}
					{product.data.github && (
						<p><a href={product.data.github}>{t('viewOnGithub')}</a></p>
					)}
				</li>
			))}
		</ul>
	</section>
</BaseLayout>

<style>
	.products ul {
		list-style: none;
		padding: 0;
	}
	.products li {
		padding: 20px;
		margin: 10px 0;
		border: 1px solid #808080;
		background-color: #f0f0f0;
	}
	.products h2 {
		margin-top: 0;
	}
</style>
